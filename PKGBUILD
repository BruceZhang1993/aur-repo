# Generated by debtap
# Maintainer: Allen Zhong <allen@moe.cat>
pkgname=corplink-bin
pkgver=2.0.11
_pkgrel=r1169_1cc3c3
pkgrel=2
pkgdesc="Linux client of Feilian (veCorpLink) from Bytedance."
arch=('x86_64')
url="https://www.volcengine.com/product/feilian"
license=('unknown')
groups=('')
depends=('gtk3' 'libxss' 'nss')
optdepends=('dnsmasq: NetworkManager integration'
            'networkmanager: NetworkManager integration')
options=('!strip' '!emptydirs')
install=${pkgname}.install
source=("https://oss-s3.ifeilian.com/linux/FeiLian_Linux_v${pkgver}_${_pkgrel}.deb")
sha512sums=('7940735621d054291bb8925faa6226e1f9e1cac1bcb6c9901744c9052f77ce4f491e5ba78dbe1db1dd53d1f09f65350d4dc3cea3c6a5e8634f01ffd59e8ed8df')

package(){
  # Extract package data
  tar xpvf "${srcdir}/data.tar.xz" --xattrs-include='*' --numeric-owner -C "${pkgdir}"

  # Fix directory structure differences
  cd "${pkgdir}"
  mkdir -p usr/bin usr/lib/systemd/system
  ln -s /opt/Corplink/Corplink usr/bin/corplink
  mv "${pkgdir}"/opt/Corplink/corplink.service usr/lib/systemd/system/corplink.service

  rm -rf usr/local
}
